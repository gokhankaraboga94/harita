<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>harita.info | TÃ¼rkiye'nin Enleri</title>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, push, onValue, update, remove } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAKkEHHeHnfHSN0MpEcJoK4Ix9o2PFbPY8",
            authDomain: "harita-4b58b.firebaseapp.com",
            projectId: "harita-4b58b",
            storageBucket: "harita-4b58b.firebasestorage.app",
            messagingSenderId: "778047554386",
            appId: "1:778047554386:web:41f29d854399a1d878b08b",
            measurementId: "G-ZNSZZC3HVS",
            databaseURL: "https://harita-4b58b-default-rtdb.firebaseio.com"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        window.db = db;
        window.adaylar = [];
        window.bekleyenAdaylar = [];

        // OnaylÄ± Adaylar
        onValue(ref(db, 'adaylar'), (snapshot) => {
            const data = snapshot.val();
            window.adaylar = data ? Object.keys(data).map(k => ({ id: k, ...data[k] })) : [];
            renderMaps();
        });

        // Bekleyen Adaylar (Moderasyon)
        onValue(ref(db, 'bekleyen_adaylar'), (snapshot) => {
            const data = snapshot.val();
            window.bekleyenAdaylar = data ? Object.keys(data).map(k => ({ id: k, ...data[k] })) : [];
            if (isAdminPage()) renderModPanel();
        });

        // GÃ¶rsel Base64'e Ã‡evirme
        function fileToBase64(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = () => resolve(reader.result);
                reader.onerror = reject;
                reader.readAsDataURL(file);
            });
        }

        // YarÄ±ÅŸmacÄ± BaÅŸvurusu
        window.submitAday = async () => {
            if (localStorage.getItem('user_has_joined')) return alert("Zaten katÄ±ldÄ±nÄ±z!");

            // VeritabanÄ± limiti kontrolÃ¼
            if (window.dbSizeLimitReached) {
                return alert("âš ï¸ ÃœzgÃ¼nÃ¼z! VeritabanÄ± kapasitesi doldu. Åu anda yeni baÅŸvuru kabul edilemiyor.");
            }

            const gender = document.getElementById('upGender').value;
            const city = parseInt(document.getElementById('upCity').value);
            const name = document.getElementById('upName').value;
            const instagram = document.getElementById('upInstagram').value.trim();
            const file = document.getElementById('upFile').files[0];
            const privacyAccepted = document.getElementById('privacyAccept').checked;

            // Gizlilik politikasÄ± kontrolÃ¼
            if (!privacyAccepted) {
                return alert("âš ï¸ Devam etmek iÃ§in Gizlilik PolitikasÄ±'nÄ± kabul etmeniz gerekmektedir.");
            }

            if (!city || !name || !file || city < 1 || city > 81) {
                return alert("LÃ¼tfen tÃ¼m zorunlu alanlarÄ± doldurun!");
            }

            if (file.size > 3 * 1024 * 1024) {
                return alert("GÃ¶rsel boyutu 3MB'dan kÃ¼Ã§Ã¼k olmalÄ±!");
            }

            try {
                document.getElementById('submitBtn').disabled = true;
                document.getElementById('submitBtn').innerText = "YÃ¼kleniyor...";

                const base64 = await fileToBase64(file);

                const newAdayRef = push(ref(db, 'bekleyen_adaylar'));
                await update(newAdayRef, {
                    gender,
                    city,
                    name,
                    instagram: instagram || null,
                    img: base64,
                    votes: 0,
                    status: 'pending',
                    createdAt: Date.now()
                });

                localStorage.setItem('user_has_joined', 'true');
                alert("BaÅŸvurunuz alÄ±ndÄ±! Admin onayÄ±ndan sonra yayÄ±nlanacak.");
                document.getElementById('uploadModal').style.display = 'none';
                location.reload();
            } catch (e) {
                alert("Hata: " + e.message);
                document.getElementById('submitBtn').disabled = false;
                document.getElementById('submitBtn').innerText = "ğŸ“¤ BaÅŸvuruyu GÃ¶nder";
            }
        };

        // Åehir OylamasÄ± - KullanÄ±cÄ± SADECE 1 ÅŸehirde oy kullanabilir (1 erkek + 1 kadÄ±n)
        window.vote = async (id) => {
            const aday = window.adaylar.find(a => a.id === id);
            if (!aday) return alert("Aday bulunamadÄ±!");

            const cityId = aday.city;
            const gender = aday.gender;

            // KullanÄ±cÄ±nÄ±n hangi ÅŸehirde oy kullandÄ±ÄŸÄ±nÄ± kontrol et
            const userVoteCity = localStorage.getItem('user_vote_city');

            // EÄŸer daha Ã¶nce farklÄ± bir ÅŸehirde oy kullandÄ±ysa, engelle
            if (userVoteCity && parseInt(userVoteCity) !== cityId) {
                const votedCityName = cityNames[parseInt(userVoteCity) - 1];
                return alert(`âš ï¸ Sadece kendi ilinizde oy kullanabilirsiniz!\n\nDaha Ã¶nce ${votedCityName} ilinde oy kullandÄ±nÄ±z.\n\nToplam oy haklarÄ±nÄ±z:\nâ€¢ Åehir: 1 erkek + 1 kadÄ±n (tek ÅŸehir)\nâ€¢ TÃ¼rkiye BirinciliÄŸi: 1 erkek + 1 kadÄ±n`);
            }

            const voteKey = `city_vote_${gender}`;

            // Bu cinsiyette oy kullandÄ± mÄ±?
            if (localStorage.getItem(voteKey)) {
                const votedId = localStorage.getItem(voteKey);
                if (votedId === id) {
                    return alert("Bu adaya zaten oy verdiniz!");
                } else {
                    return alert(`${cityNames[cityId - 1]} ilinde ${gender === 'male' ? 'erkek' : 'kadÄ±n'} kategorisinde zaten oy kullandÄ±nÄ±z!`);
                }
            }

            await update(ref(db, `adaylar/${id}`), { votes: (aday.votes || 0) + 1 });
            localStorage.setItem(voteKey, id);
            localStorage.setItem('user_vote_city', cityId.toString());

            alert(`âœ… Oyunuz kaydedildi!\n\nğŸ“ ${cityNames[cityId - 1]} - ${gender === 'male' ? 'Erkek' : 'KadÄ±n'}\n\nâ„¹ï¸ Toplam oy haklarÄ±nÄ±z:\nâ€¢ Åehir: 1 erkek + 1 kadÄ±n (sadece bu ÅŸehir)\nâ€¢ TÃ¼rkiye BirinciliÄŸi: 1 erkek + 1 kadÄ±n`);
            document.getElementById('voteModal').style.display = 'none';
        };

        // TÃ¼rkiye BirinciliÄŸi OylamasÄ± - AyrÄ± 1 erkek + 1 kadÄ±n oy hakkÄ±
        window.voteTurkey = async (id) => {
            const aday = window.adaylar.find(a => a.id === id);
            if (!aday) return alert("Aday bulunamadÄ±!");

            const gender = aday.gender;
            const voteKey = `turkey_vote_${gender}`;

            // TÃ¼rkiye oylamasÄ±nda bu cinsiyetten birine zaten oy verildi mi?
            if (localStorage.getItem(voteKey)) {
                const votedId = localStorage.getItem(voteKey);
                if (votedId === id) {
                    return alert("Bu adaya zaten TÃ¼rkiye BirinciliÄŸi oyunuzu verdiniz!");
                } else {
                    return alert(`TÃ¼rkiye BirinciliÄŸi'nde ${gender === 'male' ? 'erkek' : 'kadÄ±n'} kategorisinde zaten oy kullandÄ±nÄ±z!`);
                }
            }

            // turkeyVotes ayrÄ± sayaÃ§ olarak kullanÄ±lÄ±yor
            await update(ref(db, `adaylar/${id}`), { turkeyVotes: (aday.turkeyVotes || 0) + 1 });
            localStorage.setItem(voteKey, id);
            alert(`ğŸ† TÃ¼rkiye BirinciliÄŸi oyunuz kaydedildi!\n\n${gender === 'male' ? 'ğŸ‘¨ Erkek' : 'ğŸ‘© KadÄ±n'} kategorisi\n\nâ„¹ï¸ TÃ¼rkiye BirinciliÄŸi'nde 1 erkek ve 1 kadÄ±n iÃ§in oy kullanabilirsiniz.`);
        };

        // Admin: BaÅŸvuruyu Onayla
        window.approveAday = async (id) => {
            const aday = window.bekleyenAdaylar.find(a => a.id === id);
            if (!aday) return;

            const newAdayRef = push(ref(db, 'adaylar'));
            await update(newAdayRef, {
                gender: aday.gender,
                city: aday.city,
                name: aday.name,
                instagram: aday.instagram,
                img: aday.img,
                votes: 0
            });

            await remove(ref(db, `bekleyen_adaylar/${id}`));
            alert("BaÅŸvuru onaylandÄ±!");
        };

        // Admin: BaÅŸvuruyu Reddet
        window.rejectAday = async (id) => {
            if (!confirm("Bu baÅŸvuruyu reddetmek istediÄŸinize emin misiniz?")) return;
            await remove(ref(db, `bekleyen_adaylar/${id}`));
            alert("BaÅŸvuru reddedildi.");
        };

        // Admin Panelini Render Et
        window.renderModPanel = () => {
            const panel = document.getElementById('modPanel');
            if (!panel) return;

            const count = document.getElementById('pendingCount');
            if (count) count.innerText = window.bekleyenAdaylar.length;

            if (window.bekleyenAdaylar.length === 0) {
                panel.innerHTML = '<p style="text-align:center; padding:20px; color:#999;">Bekleyen baÅŸvuru yok.</p>';
                return;
            }

            panel.innerHTML = window.bekleyenAdaylar.map(a => `
                <div style="border:1px solid #ddd; border-radius:10px; padding:15px; margin-bottom:15px; background:#fff;">
                    <div style="display:flex; align-items:center; gap:15px; margin-bottom:10px;">
                        <img src="${a.img}" style="width:80px; height:80px; border-radius:10px; object-fit:cover;">
                        <div style="flex:1;">
                            <h3 style="margin:0 0 5px 0;">${a.name}</h3>
                            <p style="margin:0; color:#666; font-size:14px;">
                                <strong>Åehir:</strong> ${a.city} - ${window.cityNames[a.city - 1]}<br>
                                <strong>Cinsiyet:</strong> ${a.gender === 'male' ? 'Erkek' : 'KadÄ±n'}<br>
                                ${a.instagram ? `<strong>Instagram:</strong> <a href="https://instagram.com/${a.instagram.replace('@', '')}" target="_blank">@${a.instagram.replace('@', '')}</a>` : '<em>Instagram yok</em>'}
                            </p>
                        </div>
                    </div>
                    <div style="display:flex; gap:10px;">
                        <button onclick="approveAday('${a.id}')" style="flex:1; background:#28a745; color:white; border:none; padding:10px; border-radius:8px; cursor:pointer; font-weight:bold;">âœ“ Onayla</button>
                        <button onclick="rejectAday('${a.id}')" style="flex:1; background:#dc3545; color:white; border:none; padding:10px; border-radius:8px; cursor:pointer; font-weight:bold;">âœ— Reddet</button>
                    </div>
                </div>
            `).join('');

            // TÃ¼rkiye birincilerini de render et
            renderTurkeyWinnersAdmin();
        };

        // Admin Panel - TÃ¼rkiye Birincileri (Gizli - Sadece Admin GÃ¶rÃ¼r)
        window.renderTurkeyWinnersAdmin = () => {
            const container = document.getElementById('turkeyWinnersAdmin');
            if (!container) return;

            const adaylar = window.adaylar || [];
            const cityNames = window.cityNames || [];

            // Her ilin birincilerini bul
            const maleWinners = [];
            const femaleWinners = [];

            for (let i = 1; i <= 81; i++) {
                const maleLeader = adaylar
                    .filter(a => a.city == i && a.gender == 'male')
                    .sort((a, b) => b.votes - a.votes)[0];
                const femaleLeader = adaylar
                    .filter(a => a.city == i && a.gender == 'female')
                    .sort((a, b) => b.votes - a.votes)[0];

                if (maleLeader) maleWinners.push({ ...maleLeader, cityName: cityNames[i - 1] });
                if (femaleLeader) femaleWinners.push({ ...femaleLeader, cityName: cityNames[i - 1] });
            }

            // TÃ¼rkiye 1.'lerini bul (turkeyVotes'a gÃ¶re - TÃ¼rkiye oylamasÄ± ayrÄ±)
            const turkeyMaleWinner = [...maleWinners].sort((a, b) => (b.turkeyVotes || 0) - (a.turkeyVotes || 0))[0];
            const turkeyFemaleWinner = [...femaleWinners].sort((a, b) => (b.turkeyVotes || 0) - (a.turkeyVotes || 0))[0];

            const renderWinnerCard = (winner, title, color) => {
                if (!winner) {
                    return `
                        <div style="flex: 1; min-width: 300px; background: #f8f9fa; border-radius: 15px; padding: 25px; text-align: center;">
                            <h3 style="color: ${color}; margin-bottom: 15px;">${title}</h3>
                            <p style="color: #999;">HenÃ¼z yeterli veri yok</p>
                        </div>
                    `;
                }

                return `
                    <div style="flex: 1; min-width: 300px; background: linear-gradient(135deg, ${color}22 0%, ${color}11 100%); border: 2px solid ${color}; border-radius: 15px; padding: 25px; text-align: center;">
                        <h3 style="color: ${color}; margin-bottom: 15px;">ğŸ† ${title}</h3>
                        <img src="${winner.img}" style="width: 120px; height: 120px; border-radius: 50%; object-fit: cover; border: 4px solid #ffd700; margin-bottom: 15px;">
                        <h2 style="margin: 0 0 10px 0; color: #333;">${winner.name}</h2>
                        <p style="color: #666; margin: 5px 0;">
                            <strong>Ä°l:</strong> ${winner.city} - ${winner.cityName}
                        </p>
                        <div style="display: flex; justify-content: center; gap: 20px; margin: 15px 0;">
                            <div style="background: #f8f9fa; padding: 10px 15px; border-radius: 8px;">
                                <small style="color: #666;">Åehir Oyu</small>
                                <p style="color: #0084ff; font-size: 20px; font-weight: bold; margin: 5px 0;">ğŸ—³ï¸ ${winner.votes || 0}</p>
                            </div>
                            <div style="background: #fff3cd; padding: 10px 15px; border-radius: 8px;">
                                <small style="color: #856404;">TÃ¼rkiye Oyu</small>
                                <p style="color: #ffc107; font-size: 20px; font-weight: bold; margin: 5px 0;">ğŸ† ${winner.turkeyVotes || 0}</p>
                            </div>
                        </div>
                        ${winner.instagram ? `
                            <a href="https://instagram.com/${winner.instagram.replace('@', '')}" target="_blank" style="display: inline-block; background: #E4405F; color: white; padding: 10px 20px; border-radius: 8px; text-decoration: none; font-weight: bold;">
                                ğŸ“· @${winner.instagram.replace('@', '')}
                            </a>
                        ` : '<em style="color: #999;">Instagram yok</em>'}
                    </div>
                `;
            };

            container.innerHTML = `
                ${renderWinnerCard(turkeyMaleWinner, 'TÃœRKÄ°YE 1. ERKEK', '#0084ff')}
                ${renderWinnerCard(turkeyFemaleWinner, 'TÃœRKÄ°YE 1. KADIN', '#ff007b')}
            `;
        };

        // Sayfa GÃ¶sterme Fonksiyonu
        window.showPage = (page) => {
            document.getElementById('mainPage').style.display = 'none';
            document.getElementById('adminPage').style.display = 'none';
            document.getElementById('contactPage').style.display = 'none';
            document.getElementById('privacyPage').style.display = 'none';

            switch (page) {
                case 'main':
                    document.getElementById('mainPage').style.display = 'block';
                    document.title = 'harita.info | TÃ¼rkiye\'nin Enleri';
                    break;
                case 'admin':
                    document.getElementById('adminPage').style.display = 'block';
                    document.title = 'Admin Panel | harita.info';
                    renderModPanel();
                    break;
                case 'contact':
                    document.getElementById('contactPage').style.display = 'block';
                    document.title = 'Ä°letiÅŸim | harita.info';
                    break;
                case 'privacy':
                    document.getElementById('privacyPage').style.display = 'block';
                    document.title = 'Gizlilik PolitikasÄ± | harita.info';
                    break;
            }
        };

        // VeritabanÄ± boyutu kontrolÃ¼ (1GB = 1073741824 bytes)
        window.dbSizeLimitReached = false;

        async function checkDatabaseSize() {
            try {
                // Firebase'den toplam veri boyutunu tahmin et
                const adaylarCount = (window.adaylar || []).length;
                const bekleyenCount = (window.bekleyenAdaylar || []).length;

                // Her aday ortalama 500KB (Base64 gÃ¶rsel) varsayÄ±mÄ±
                const estimatedSize = (adaylarCount + bekleyenCount) * 500 * 1024;
                const limitSize = 1 * 1024 * 1024 * 1024; // 1GB

                window.dbSizeLimitReached = estimatedSize >= limitSize;

                // Admin paneline boyut bilgisi ekle
                const statsDiv = document.getElementById('dbStats');
                if (statsDiv) {
                    const usedMB = (estimatedSize / (1024 * 1024)).toFixed(2);
                    const limitMB = (limitSize / (1024 * 1024)).toFixed(0);
                    const percentage = ((estimatedSize / limitSize) * 100).toFixed(1);

                    statsDiv.innerHTML = `
                        <div style="background: ${percentage > 80 ? '#f8d7da' : '#d4edda'}; padding: 15px; border-radius: 10px; margin-bottom: 20px;">
                            <h4 style="margin: 0 0 10px 0;">ğŸ“Š VeritabanÄ± Durumu</h4>
                            <p style="margin: 5px 0;">KullanÄ±lan: <strong>${usedMB} MB</strong> / ${limitMB} MB</p>
                            <div style="background: #e9ecef; border-radius: 5px; height: 20px; overflow: hidden;">
                                <div style="background: ${percentage > 80 ? '#dc3545' : '#28a745'}; height: 100%; width: ${Math.min(percentage, 100)}%;"></div>
                            </div>
                            <p style="margin: 5px 0; font-size: 12px; color: #666;">${percentage}% kullanÄ±lÄ±yor</p>
                            ${window.dbSizeLimitReached ? '<p style="color: #dc3545; font-weight: bold;">âš ï¸ Limit aÅŸÄ±ldÄ±! Yeni baÅŸvurular kapatÄ±ldÄ±.</p>' : ''}
                        </div>
                    `;
                }
            } catch (e) {
                console.log('DB boyutu kontrol hatasÄ±:', e);
            }
        }

        // Sayfa yÃ¶nlendirmesi
        function isAdminPage() {
            return window.location.pathname === '/adminpanel' || window.location.hash === '#/adminpanel';
        }

        function isContactPage() {
            return window.location.pathname === '/iletisim' || window.location.hash === '#/iletisim';
        }

        function isPrivacyPage() {
            return window.location.pathname === '/gizlilik' || window.location.hash === '#/gizlilik';
        }

        // Sayfa yÃ¼klendiÄŸinde kontrol
        window.addEventListener('load', () => {
            if (isAdminPage()) {
                showPage('admin');
            } else if (isContactPage()) {
                showPage('contact');
            } else if (isPrivacyPage()) {
                showPage('privacy');
            }

            // DB boyutunu kontrol et
            setTimeout(checkDatabaseSize, 2000);
        });
    </script>

    <style>
        :root {
            --male: #0084ff;
            --female: #ff007b;
            --dark: #121212;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', sans-serif;
        }

        body {
            background: #f8f9fa;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        header {
            background: var(--dark);
            color: white;
            padding: 15px;
            text-align: center;
            position: relative;
        }

        .tab-controls {
            display: flex;
            background: #fff;
            border-bottom: 1px solid #ddd;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .tab-btn {
            flex: 1;
            padding: 15px;
            border: none;
            font-weight: bold;
            cursor: pointer;
            opacity: 0.5;
            background: white;
            font-size: 12px;
        }

        .active-male {
            border-bottom: 4px solid var(--male);
            opacity: 1;
            color: var(--male);
        }

        .active-female {
            border-bottom: 4px solid var(--female);
            opacity: 1;
            color: var(--female);
        }

.city-none {
    fill: #e0e0e0 !important;
    opacity: 0.4;
    cursor: not-allowed;
}

.city-single {
    fill: #ffc107 !important;
    opacity: 0.8;
}

.city-both {
    fill: #28a745 !important;
    opacity: 1;
}

.city-both:hover,
.city-single:hover {
    stroke: #000;
    stroke-width: 2px;
}



        .active-winners {
            border-bottom: 4px solid #ffd700;
            opacity: 1;
            color: #ffd700;
        }

        .container {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        .pane {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 10px;
            overflow-y: auto;
        }

        .pane-male {
            background: #f0f7ff;
        }

        .pane-female {
            background: #fff5f8;
        }

        svg {
            width: 100%;
            max-width: 900px;
            height: auto;
        }

        .city-rect {
            stroke: #ccc;
            stroke-width: 0.5;
            cursor: pointer;
            transition: 0.2s;
        }

        .city-rect:hover {
            stroke: #333;
            stroke-width: 1.5;
        }

     .city-label {
    font-size: 12px !important;
    font-weight: 700;
    fill: #000;
    paint-order: stroke;
    stroke: #fff;
    stroke-width: 3px;
}


        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            padding: 15px;
        }

        .modal-content {
            background: #fff;
            padding: 25px;
            border-radius: 15px;
            width: 100%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
        }

        input,
        select {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
        }

        .btn-main {
            background: #ff9800;
            color: #fff;
            padding: 10px 20px;
            border: none;
            border-radius: 20px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 10px;
        }

        .btn-main:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .instagram-info {
            background: #f0f0f0;
            padding: 10px;
            border-radius: 8px;
            font-size: 12px;
            color: #666;
            margin: 5px 0;
        }

        .admin-page {
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .candidate-instagram {
            color: #E4405F;
            font-weight: 600;
            text-decoration: none;
            font-size: 11px;
        }

        .candidate-instagram:hover {
            text-decoration: underline;
        }

        @media (max-width: 768px) {
            .pane {
                display: none;
            }

            .pane.mobile-active {
                display: flex;
            }
        }
    </style>
</head>

<body>

    <div id="mainPage">
        <header>
            <h1>harita.info</h1>
            <div id="joinArea"></div>
        </header>

        <div class="tab-controls">
            <button class="tab-btn active-male" id="btnM" onclick="switchTab('male')">ERKEKLER</button>
            <button class="tab-btn" id="btnF" onclick="switchTab('female')">KADINLAR</button>
            <button class="tab-btn" id="btnW" onclick="switchTab('winners')">TÃœRKÄ°YE BÄ°RÄ°NCÄ°LERÄ°</button>
        </div>

        <div class="container">
            <div class="pane pane-male mobile-active" id="paneMale">
                <div id="svgMale"></div>
            </div>
            <div class="pane pane-female" id="paneFemale">
                <div id="svgFemale"></div>
            </div>
            <div class="pane" id="paneWinners"
                style="background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); flex-direction: row; flex-wrap: wrap; justify-content: center; gap: 20px; padding: 20px;">
                <div id="winnersContent" style="width: 100%; max-width: 1400px;"></div>
            </div>
        </div>

        <!-- Bilgilendirme Notu -->
        <div
            style="background: #e8f4fd; border-left: 4px solid #0084ff; padding: 15px; margin: 15px; border-radius: 8px;">
    <p style="margin: 0; font-size: 13px; color: #333;">
    â„¹ï¸ <strong>Oylama KurallarÄ±:</strong><br>
    YalnÄ±zca <strong>1 erkek</strong> ve <strong>1 kadÄ±n</strong> aday iÃ§in oy kullanabilirsiniz. 
    LÃ¼tfen oyunuzu <strong>yaÅŸadÄ±ÄŸÄ±nÄ±z ÅŸehir</strong> iÃ§in kullanÄ±nÄ±z.<br>
    TÃ¼rkiye BirinciliÄŸi iÃ§in ayrÄ±ca <strong>1 erkek</strong> ve <strong>1 kadÄ±n</strong> aday iÃ§in oy hakkÄ±nÄ±z bulunmaktadÄ±r.<br>
    Bu oylar <strong>birbirinden baÄŸÄ±msÄ±zdÄ±r TÃ¼rkiye kadÄ±n/erkek birincileri @enharitalar instagram hesabÄ±ndan paylaÅŸÄ±lacaktÄ±r</strong>.
</p>

        </div>

        <!-- Footer -->
        <footer style="background: #121212; color: #999; padding: 20px; text-align: center; font-size: 12px;">
            <div style="margin-bottom: 10px;">
                <a href="/iletisim" onclick="showPage('contact'); return false;"
                    style="color: #0084ff; text-decoration: none; margin: 0 10px;">ğŸ“§ Ä°letiÅŸim</a>
                <a href="/gizlilik" onclick="showPage('privacy'); return false;"
                    style="color: #0084ff; text-decoration: none; margin: 0 10px;">ğŸ”’ Gizlilik PolitikasÄ±</a>
            </div>
            <p style="margin: 0;">Â© 2024 harita.info - TÃ¼m haklarÄ± saklÄ±dÄ±r.</p>
            <p style="margin: 5px 0 0 0; font-size: 10px; color: #666;">
                KVKK kapsamÄ±nda kiÅŸisel verileriniz korunmaktadÄ±r.
            </p>
        </footer>
    </div>

    <!-- Ä°letiÅŸim SayfasÄ± -->
    <div id="contactPage" style="display:none;">
        <header>
            <h1>ğŸ“§ Ä°letiÅŸim</h1>
            <a href="/" onclick="showPage('main'); return false;"
                style="color:white; text-decoration:none; font-size:14px;">â† Ana Sayfa</a>
        </header>
        <div style="max-width: 800px; margin: 0 auto; padding: 30px;">
            <div style="background: white; border-radius: 15px; padding: 30px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                <h2 style="margin-bottom: 20px; color: #333;">Bize UlaÅŸÄ±n</h2>
                <p style="color: #666; line-height: 1.8;">
                    SorularÄ±nÄ±z, Ã¶nerileriniz veya ÅŸikayetleriniz iÃ§in bizimle iletiÅŸime geÃ§ebilirsiniz.
                </p>
                <div style="margin: 20px 0; padding: 20px; background: #f8f9fa; border-radius: 10px;">
                    <p style="margin: 10px 0;"><strong>ğŸ“§ E-posta:</strong> enharitalar@gmail.com</p>
                    <p style="margin: 10px 0;"><strong>ğŸ“· Instagram:</strong> @enharitalar</p>
                </div>
                <div
                    style="margin-top: 20px; padding: 15px; background: #fff3cd; border-radius: 10px; border-left: 4px solid #ffc107;">
                    <p style="margin: 0; font-size: 13px; color: #856404;">
                        âš ï¸ <strong>Ã–nemli:</strong> YarÄ±ÅŸma ile ilgili itirazlarÄ±nÄ±zÄ± en geÃ§ yarÄ±ÅŸma bitiÅŸ tarihinden 7
                        gÃ¼n sonrasÄ±na kadar iletebilirsiniz.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Gizlilik PolitikasÄ± SayfasÄ± -->
    <div id="privacyPage" style="display:none;">
        <header>
            <h1>ğŸ”’ Gizlilik PolitikasÄ±</h1>
            <a href="/" onclick="showPage('main'); return false;"
                style="color:white; text-decoration:none; font-size:14px;">â† Ana Sayfa</a>
        </header>
        <div style="max-width: 800px; margin: 0 auto; padding: 30px;">
            <div style="background: white; border-radius: 15px; padding: 30px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                <h2 style="margin-bottom: 20px; color: #333;">KiÅŸisel Verilerin KorunmasÄ± (KVKK)</h2>

                <div style="margin-bottom: 25px;">
                    <h3 style="color: #0084ff; margin-bottom: 10px;">1. Toplanan Veriler</h3>
                    <p style="color: #666; line-height: 1.8;">
                        YarÄ±ÅŸmaya katÄ±lÄ±m sÄ±rasÄ±nda aÅŸaÄŸÄ±daki veriler toplanmaktadÄ±r:
                    </p>
                    <ul style="color: #666; line-height: 2;">
                        <li>Ad Soyad</li>
                        <li>Ä°l Bilgisi (Plaka Kodu)</li>
                        <li>Cinsiyet</li>
                        <li>Profil FotoÄŸrafÄ±</li>
                        <li>Instagram KullanÄ±cÄ± AdÄ± (Ä°steÄŸe BaÄŸlÄ±)</li>
                    </ul>
                </div>

                <div style="margin-bottom: 25px;">
                    <h3 style="color: #0084ff; margin-bottom: 10px;">2. Verilerin KullanÄ±m AmacÄ±</h3>
                    <p style="color: #666; line-height: 1.8;">
                        Toplanan veriler yalnÄ±zca yarÄ±ÅŸma sÃ¼recinde kullanÄ±lmaktadÄ±r:
                    </p>
                    <ul style="color: #666; line-height: 2;">
                        <li>YarÄ±ÅŸmacÄ±larÄ±n platformda gÃ¶rÃ¼ntÃ¼lenmesi</li>
                        <li>Oylama sÃ¼recinin yÃ¶netimi</li>
                        <li>KazananlarÄ±n duyurulmasÄ±</li>
                    </ul>
                </div>

                <div style="margin-bottom: 25px;">
                    <h3 style="color: #0084ff; margin-bottom: 10px;">3. Veri GÃ¼venliÄŸi</h3>
                    <p style="color: #666; line-height: 1.8;">
                        Verileriniz Firebase altyapÄ±sÄ± kullanÄ±larak gÃ¼venli bir ÅŸekilde saklanmaktadÄ±r.
                        SSL ÅŸifreleme ile korunmaktadÄ±r.
                    </p>
                </div>

                <div style="margin-bottom: 25px;">
                    <h3 style="color: #0084ff; margin-bottom: 10px;">4. Veri Saklama SÃ¼resi</h3>
                    <p style="color: #666; line-height: 1.8;">
                        YarÄ±ÅŸma sona erdikten sonra verileriniz 1 yÄ±l sÃ¼reyle saklanÄ±r ve ardÄ±ndan silinir.
                        KazananlarÄ±n verileri izin dahilinde saklanmaya devam edebilir.
                    </p>
                </div>

                <div style="margin-bottom: 25px;">
                    <h3 style="color: #0084ff; margin-bottom: 10px;">5. HaklarÄ±nÄ±z</h3>
                    <p style="color: #666; line-height: 1.8;">
                        KVKK kapsamÄ±nda aÅŸaÄŸÄ±daki haklara sahipsiniz:
                    </p>
                    <ul style="color: #666; line-height: 2;">
                        <li>KiÅŸisel verilerinizin iÅŸlenip iÅŸlenmediÄŸini Ã¶ÄŸrenme</li>
                        <li>KiÅŸisel verileriniz iÅŸlenmiÅŸse bilgi talep etme</li>
                        <li>KiÅŸisel verilerinizin silinmesini isteme</li>
                        <li>Ä°ÅŸlenen verilerin dÃ¼zeltilmesini talep etme</li>
                    </ul>
                </div>

                <div style="padding: 15px; background: #d4edda; border-radius: 10px; border-left: 4px solid #28a745;">
                    <p style="margin: 0; font-size: 13px; color: #155724;">
                        âœ… YarÄ±ÅŸmaya katÄ±larak bu gizlilik politikasÄ±nÄ± kabul etmiÅŸ sayÄ±lÄ±rsÄ±nÄ±z.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <div id="adminPage" style="display:none;">
        <header style="background:#dc3545;">
            <h1>ğŸ” Moderasyon Paneli</h1>
            <a href="/" onclick="showPage('main'); return false;"
                style="color:white; text-decoration:none; font-size:14px;">â† Ana Sayfa</a>
        </header>
        <div class="admin-page">
            <!-- VeritabanÄ± Ä°statistikleri -->
            <div id="dbStats"></div>

            <h2 style="margin-bottom:20px;">Bekleyen BaÅŸvurular (<span id="pendingCount">0</span>)</h2>
            <div id="modPanel"></div>

            <hr style="margin: 40px 0; border: none; border-top: 2px solid #ddd;">

            <h2 style="margin-bottom:20px;">ğŸ† TÃ¼rkiye Birincileri (Gizli)</h2>
            <div id="turkeyWinnersAdmin" style="display: flex; gap: 30px; flex-wrap: wrap;"></div>
        </div>
    </div>

    <div id="uploadModal" class="modal">
        <div class="modal-content" style="background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);">
            <h3 style="text-align: center; margin-bottom: 20px; color: #333; font-size: 22px;">ğŸ† YarÄ±ÅŸmaya KatÄ±l</h3>

            <div style="margin-bottom: 15px;">
                <label
                    style="display: block; font-size: 13px; color: #666; margin-bottom: 5px; font-weight: 600;">Cinsiyet</label>
                <select id="upGender"
                    style="background: #fff; border: 2px solid #e0e0e0; border-radius: 10px; padding: 12px 15px; font-size: 15px; transition: border-color 0.3s;">
                    <option value="male">ğŸ‘¨ Erkek</option>
                    <option value="female">ğŸ‘© KadÄ±n</option>
                </select>
            </div>

            <div style="margin-bottom: 15px;">
                <label style="display: block; font-size: 13px; color: #666; margin-bottom: 5px; font-weight: 600;">Ä°l
                    Plaka Kodu</label>
                <input type="number" id="upCity" placeholder="1-81 arasÄ± plaka kodu girin" min="1" max="81"
                    style="background: #fff; border: 2px solid #e0e0e0; border-radius: 10px; padding: 12px 15px; font-size: 15px;">
            </div>

            <div style="margin-bottom: 15px;">
                <label style="display: block; font-size: 13px; color: #666; margin-bottom: 5px; font-weight: 600;">Ad
                    Soyad *</label>
                <input type="text" id="upName" placeholder="AdÄ±nÄ±z ve soyadÄ±nÄ±z"
                    style="background: #fff; border: 2px solid #e0e0e0; border-radius: 10px; padding: 12px 15px; font-size: 15px;">
            </div>

            <div style="margin-bottom: 15px;">
                <label
                    style="display: block; font-size: 13px; color: #666; margin-bottom: 5px; font-weight: 600;">Instagram
                    (Ä°steÄŸe BaÄŸlÄ±)</label>
                <input type="text" id="upInstagram" placeholder="@kullanici_adi"
                    style="background: #fff; border: 2px solid #e0e0e0; border-radius: 10px; padding: 12px 15px; font-size: 15px;">
                <div
                    style="background: linear-gradient(135deg, #e8f4fd 0%, #f0f7ff 100%); padding: 10px 12px; border-radius: 8px; font-size: 12px; color: #0084ff; margin-top: 8px; border-left: 3px solid #0084ff;">
                    ğŸ’¡ Instagram hesabÄ±nÄ±zÄ± eklerseniz, kazandÄ±ÄŸÄ±nÄ±zda profiliniz gÃ¶rÃ¼ntÃ¼lenecek.
                </div>
            </div>

            <div style="margin-bottom: 15px;">
                <label
                    style="display: block; font-size: 13px; color: #666; margin-bottom: 5px; font-weight: 600;">FotoÄŸraf
                    *</label>
                <input type="file" id="upFile" accept="image/*"
                    style="background: #fff; border: 2px dashed #e0e0e0; border-radius: 10px; padding: 15px; font-size: 14px; cursor: pointer;">
                <div style="font-size: 11px; color: #999; margin-top: 5px;">
                    âš ï¸ GÃ¶rsel boyutu maksimum 3MB olmalÄ±dÄ±r
                </div>
            </div>

            <!-- Gizlilik PolitikasÄ± Onay Kutusu -->
            <div
                style="background: #fff3cd; padding: 12px 15px; border-radius: 10px; margin-bottom: 15px; border: 1px solid #ffc107;">
                <label style="display: flex; align-items: flex-start; gap: 10px; cursor: pointer;">
                    <input type="checkbox" id="privacyAccept"
                        style="width: 20px; height: 20px; margin-top: 2px; accent-color: #28a745; cursor: pointer;">
                    <span style="font-size: 13px; color: #856404; line-height: 1.5;">
                        <a href="javascript:void(0)"
                            onclick="document.getElementById('uploadModal').style.display='none'; showPage('privacy');"
                            style="color: #0084ff; text-decoration: underline; font-weight: 600;">Gizlilik
                            PolitikasÄ±</a>'nÄ± okudum ve kabul ediyorum. KiÅŸisel verilerimin yarÄ±ÅŸma sÃ¼resince
                        iÅŸlenmesine onay veriyorum.
                    </span>
                </label>
            </div>

            <button class="btn-main" id="submitBtn"
                style="width:100%; background: linear-gradient(135deg, #28a745 0%, #20c997 100%); padding: 14px; font-size: 16px; border-radius: 12px; box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);"
                onclick="submitAday()">
                ğŸ“¤ BaÅŸvuruyu GÃ¶nder
            </button>
            <button onclick="document.getElementById('uploadModal').style.display='none'"
                style="width:100%; margin-top:12px; background:none; border: 1px solid #ddd; padding: 12px; border-radius: 10px; color:#666; cursor:pointer; font-size: 14px; transition: background 0.3s;">
                âœ– Ä°ptal
            </button>
        </div>
    </div>

    <div id="voteModal" class="modal">
        <div class="modal-content">
            <h3 id="vTitle">Åehir AdaylarÄ±</h3>
            <div id="candidateList" style="margin-top:15px; max-height:400px; overflow-y:auto;"></div>
            <button onclick="document.getElementById('voteModal').style.display='none'"
                style="width:100%; margin-top:15px; padding:10px;">Kapat</button>
        </div>
    </div>

    <script>
        const cityNames = ["Adana", "AdÄ±yaman", "Afyon", "AÄŸrÄ±", "Amasya", "Ankara", "Antalya", "Artvin", "AydÄ±n", "BalÄ±kesir", "Bilecik", "BingÃ¶l", "Bitlis", "Bolu", "Burdur", "Bursa", "Ã‡anakkale", "Ã‡ankÄ±rÄ±", "Ã‡orum", "Denizli", "DiyarbakÄ±r", "Edirne", "ElazÄ±ÄŸ", "Erzincan", "Erzurum", "EskiÅŸehir", "Gaziantep", "Giresun", "GÃ¼mÃ¼ÅŸhane", "Hakkari", "Hatay", "Isparta", "Mersin", "Ä°stanbul", "Ä°zmir", "Kars", "Kastamonu", "Kayseri", "KÄ±rklareli", "KÄ±rÅŸehir", "Kocaeli", "Konya", "KÃ¼tahya", "Malatya", "Manisa", "K.MaraÅŸ", "Mardin", "MuÄŸla", "MuÅŸ", "NevÅŸehir", "NiÄŸde", "Ordu", "Rize", "Sakarya", "Samsun", "Siirt", "Sinop", "Sivas", "TekirdaÄŸ", "Tokat", "Trabzon", "Tunceli", "ÅanlÄ±urfa", "UÅŸak", "Van", "Yozgat", "Zonguldak", "Aksaray", "Bayburt", "Karaman", "KÄ±rÄ±kkale", "Batman", "ÅÄ±rnak", "BartÄ±n", "Ardahan", "IÄŸdÄ±r", "Yalova", "KarabÃ¼k", "Kilis", "Osmaniye", "DÃ¼zce"];

        window.cityNames = cityNames;

        function switchTab(g) {
            document.getElementById('paneMale').classList.toggle('mobile-active', g === 'male');
            document.getElementById('paneFemale').classList.toggle('mobile-active', g === 'female');
            document.getElementById('paneWinners').classList.toggle('mobile-active', g === 'winners');
            document.getElementById('btnM').classList.toggle('active-male', g === 'male');
            document.getElementById('btnF').classList.toggle('active-female', g === 'female');
            document.getElementById('btnW').classList.toggle('active-winners', g === 'winners');

            // TÃ¼rkiye Birincileri sekmesi aÃ§Ä±ldÄ±ÄŸÄ±nda render et
            if (g === 'winners') {
                renderWinners();
            }
        }

        // Rastgele sÄ±ralama fonksiyonu
        function shuffleArray(array) {
            const arr = [...array];
            for (let i = arr.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [arr[i], arr[j]] = [arr[j], arr[i]];
            }
            return arr;
        }

        // Her ilin birincilerini bul
        function getCityWinners() {
            const maleWinners = [];
            const femaleWinners = [];

            for (let i = 1; i <= 81; i++) {
                const maleLeader = (window.adaylar || [])
                    .filter(a => a.city == i && a.gender == 'male')
                    .sort((a, b) => b.votes - a.votes)[0];
                const femaleLeader = (window.adaylar || [])
                    .filter(a => a.city == i && a.gender == 'female')
                    .sort((a, b) => b.votes - a.votes)[0];

                if (maleLeader) maleWinners.push({ ...maleLeader, cityName: cityNames[i - 1] });
                if (femaleLeader) femaleWinners.push({ ...femaleLeader, cityName: cityNames[i - 1] });
            }

            return { maleWinners, femaleWinners };
        }

        // TÃ¼rkiye Birincileri sekmesini render et
        function renderWinners() {
            const container = document.getElementById('winnersContent');
            if (!container) return;

            const { maleWinners, femaleWinners } = getCityWinners();

            // Rastgele sÄ±rala (oy sayÄ±sÄ± gizli olacaÄŸÄ± iÃ§in)
            const shuffledMale = shuffleArray(maleWinners);
            const shuffledFemale = shuffleArray(femaleWinners);

            // Oy kullanÄ±m durumunu kontrol et
            const maleVoted = localStorage.getItem('turkey_vote_male');
            const femaleVoted = localStorage.getItem('turkey_vote_female');

            const renderCard = (a) => `
            <div style="background: rgba(255,255,255,0.1); border-radius: 15px; padding: 15px; text-align: center; width: 140px; backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.2);">
                <img src="${a.img}" style="width: 80px; height: 80px; border-radius: 50%; object-fit: cover; border: 3px solid #ffd700; margin-bottom: 10px;">
                <div style="color: white; font-weight: bold; font-size: 13px; margin-bottom: 5px;">${a.name}</div>
                <div style="color: #ffd700; font-size: 11px; margin-bottom: 5px;">${a.city} - ${a.cityName}</div>
                ${a.instagram ? `<a href="https://instagram.com/${a.instagram.replace('@', '')}" target="_blank" style="color: #E4405F; font-size: 10px; text-decoration: none;">ğŸ“· @${a.instagram.replace('@', '')}</a>` : ''}
                <button onclick="voteTurkey('${a.id}')" style="margin-top: 10px; background: linear-gradient(135deg, #ffd700 0%, #ff8c00 100%); color: #333; border: none; padding: 8px 12px; border-radius: 8px; cursor: pointer; font-size: 11px; font-weight: bold; width: 100%;">
                    ğŸ† TÃ¼rkiye Oyu
                </button>
            </div>
        `;

            container.innerHTML = `
            <div style="background: rgba(255,255,255,0.1); border-radius: 10px; padding: 15px; margin-bottom: 20px; text-align: center;">
                <p style="color: #ffd700; font-size: 14px; margin: 0;">
                    â„¹ï¸ <strong>TÃ¼rkiye BirinciliÄŸi OylamasÄ±</strong><br>
                    <span style="font-size: 12px; color: #ccc;">Her kullanÄ±cÄ± 1 erkek ve 1 kadÄ±n iÃ§in oy kullanabilir. Bu oylar ÅŸehir oylarÄ±ndan ayrÄ±dÄ±r.</span>
                </p>
                <div style="margin-top: 10px; font-size: 12px;">
                    <span style="color: ${maleVoted ? '#28a745' : '#666'};">ğŸ‘¨ Erkek: ${maleVoted ? 'âœ… Oy KullanÄ±ldÄ±' : 'â³ Oy HakkÄ±nÄ±z Var'}</span>
                    <span style="margin-left: 20px; color: ${femaleVoted ? '#28a745' : '#666'};">ğŸ‘© KadÄ±n: ${femaleVoted ? 'âœ… Oy KullanÄ±ldÄ±' : 'â³ Oy HakkÄ±nÄ±z Var'}</span>
                </div>
            </div>
            
            <div style="margin-bottom: 30px;">
                <h2 style="color: #0084ff; text-align: center; margin-bottom: 20px; font-size: 20px;">
                    ğŸ‘¨ Erkek Ä°l Birincileri (${shuffledMale.length} Ä°l)
                </h2>
                <div style="display: flex; flex-wrap: wrap; gap: 15px; justify-content: center;">
                    ${shuffledMale.length > 0 ? shuffledMale.map(a => renderCard(a)).join('') : '<p style="color: #999; text-align: center; width: 100%;">HenÃ¼z erkek birincisi yok</p>'}
                </div>
            </div>
            
            <hr style="border: none; border-top: 1px solid rgba(255,255,255,0.2); margin: 30px 0;">
            
            <div>
                <h2 style="color: #ff007b; text-align: center; margin-bottom: 20px; font-size: 20px;">
                    ğŸ‘© KadÄ±n Ä°l Birincileri (${shuffledFemale.length} Ä°l)
                </h2>
                <div style="display: flex; flex-wrap: wrap; gap: 15px; justify-content: center;">
                    ${shuffledFemale.length > 0 ? shuffledFemale.map(a => renderCard(a)).join('') : '<p style="color: #999; text-align: center; width: 100%;">HenÃ¼z kadÄ±n birincisi yok</p>'}
                </div>
            </div>
        `;
        }

        function renderMaps() {
            const draw = (id, gender) => {
                let defs = "<defs>";
                let content = "";
                for (let i = 1; i <= 81; i++) {
                    const leader = (window.adaylar || []).filter(a => a.city == i && a.gender == gender).sort((a, b) => b.votes - a.votes)[0];
                    let fill = "#fff";
                    // Lider varsa da gÃ¶rseli gÃ¶sterme, sadece boÅŸ beyaz kutu
                    const x = ((i - 1) % 9) * 95;
                    const y = Math.floor((i - 1) / 9) * 65;
                    content += `<rect x="${x}" y="${y}" width="90" height="60" class="city-rect" style="fill:${fill}" onclick="openCity(${i},'${gender}')"/>
                <text x="${x + 45}" y="${y + 25}" class="city-label">${i}</text>
                <text x="${x + 45}" y="${y + 42}" class="city-label" style="font-size:5px; opacity:0.6;">${cityNames[i - 1]}</text>`;
                }
                const svgEl = document.getElementById(id);
                if (svgEl) svgEl.innerHTML = `<svg viewBox="-5 -5 860 600">${defs}</defs>${content}</svg>`;
            };
            draw('svgMale', 'male');
            draw('svgFemale', 'female');
            updateBtn();
        }

        function updateBtn() {
            const joinArea = document.getElementById('joinArea');
            if (!joinArea) return;
            if (localStorage.getItem('user_has_joined')) {
                joinArea.innerHTML = `<button class="btn-main" style="background:#28a745" disabled>âœ“ BaÅŸvurunuz AlÄ±ndÄ±</button>`;
            } else {
                joinArea.innerHTML = `<button class="btn-main" onclick="document.getElementById('uploadModal').style.display='flex'">ğŸ† YarÄ±ÅŸmacÄ± Ol</button>`;
            }
        }

        function openCity(cityId, gender) {
            const filtered = (window.adaylar || []).filter(a => a.city == cityId && a.gender == gender).sort((a, b) => b.votes - a.votes);
            document.getElementById('vTitle').innerText = cityId + " - " + cityNames[cityId - 1] + " AdaylarÄ±";
            const list = document.getElementById('candidateList');

            if (filtered.length === 0) {
                list.innerHTML = "<p style='text-align:center; padding:20px; color:#999;'>Bu ÅŸehirde henÃ¼z aday yok.</p>";
            } else {
                list.innerHTML = filtered.map((a, idx) => `
                <div style="display:flex; align-items:center; margin-bottom:12px; padding:12px; border:1px solid ${idx === 0 ? '#ffd700' : '#eee'}; border-radius:10px; background:${idx === 0 ? '#fffbf0' : 'white'};">
                    ${idx === 0 ? '<span style="font-size:24px; margin-right:8px;">ğŸ‘‘</span>' : ''}
                    <img src="${a.img}" style="width:60px; height:60px; border-radius:50%; object-fit:cover; margin-right:12px; border:2px solid ${idx === 0 ? '#ffd700' : '#ddd'};">
                    <div style="flex:1;">
                        <b style="font-size:15px;">${a.name}</b>
                        ${a.instagram ? `<br><a href="https://instagram.com/${a.instagram.replace('@', '')}" target="_blank" class="candidate-instagram">ğŸ“· @${a.instagram.replace('@', '')}</a>` : ''}
                        <br><small style="color:#666;">${a.votes} Oy</small>
                    </div>
                    <button onclick="vote('${a.id}')" style="background:linear-gradient(135deg, #667eea 0%, #764ba2 100%); color:white; border:none; padding:10px 16px; border-radius:8px; cursor:pointer; font-weight:bold; box-shadow:0 2px 8px rgba(102,126,234,0.3);">
                        â­ Oy Ver
                    </button>
                </div>
            `).join('');
            }

            document.getElementById('voteModal').style.display = 'flex';
        }

        // Ä°lk render
        renderMaps();
        updateBtn();

function getCityCandidateStatus(cityId) {
    const list = window.adaylar || [];

    const hasMale = list.some(a => a.city === cityId && a.gender === 'male');
    const hasFemale = list.some(a => a.city === cityId && a.gender === 'female');

    if (hasMale && hasFemale) return 'both';
    if (hasMale || hasFemale) return 'single';
    return 'none';
}



    </script>
</body>

</html>
